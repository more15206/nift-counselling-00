<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NIFT B.Des Admissions: Your Personalized Rank Analysis</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation@1.0.2"></script>
    <script>
        // Register the annotation plugin globally as soon as it's loaded.
        // This ensures the plugin is available before any charts are created.
        Chart.register(ChartjsPluginAnnotation);
    </script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;900&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f4f8; 
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 700px;
            margin-left: auto;
            margin-right: auto;
            height: 400px;
            max-height: 450px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 450px;
            }
        }
        .flowchart-step {
            display: flex;
            align-items: center;
            text-align: left;
            position: relative;
            padding-left: 50px;
        }
        .flowchart-step-icon {
            position: absolute;
            left: 0;
            top: 50%;
            transform: translateY(-50%);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
        }
        .flowchart-line {
            position: absolute;
            left: 19px;
            top: 100%;
            width: 2px;
            height: 3rem; 
        }
        .info-tooltip {
            position: relative;
            display: inline-block;
            cursor: pointer;
            margin-left: 8px;
        }
        .info-tooltip .tooltiptext {
            visibility: hidden;
            width: 300px;
            background-color: #334155;
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 10px;
            position: absolute;
            z-index: 10;
            bottom: 125%; /* Position above the text */
            left: 50%;
            margin-left: -150px; /* Center the tooltip */
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 0.8rem;
            line-height: 1.3;
        }
        .info-tooltip .tooltiptext::after {
            content: "";
            position: absolute;
            top: 100%;
            left: 50%;
            margin-left: -5px;
            border-width: 5px;
            border-style: solid;
            border-color: #334155 transparent transparent transparent;
        }
        .info-tooltip.active .tooltiptext {
            visibility: visible;
            opacity: 1;
        }
    </style>
</head>
<body class="text-gray-800">
    
    <header class="bg-white shadow-md sticky top-0 z-50">
        <div class="container mx-auto px-6 py-4">
            <h1 class="text-xl md:text-3xl font-bold text-center" style="color: #004AAD;">Navigating Your NIFT B.Des Admission</h1>
            <p class="text-center text-sm md:text-base text-gray-600 mt-1">A Personalized Infographic for Your Rank</p>
        </div>
    </header>

    <main class="container mx-auto px-4 sm:px-6 py-8">

        <section id="ranks" class="mb-12">
            <div class="text-center mb-8">
                <h2 class="text-2xl md:text-4xl font-bold" style="color: #004AAD;">Understanding Your Ranks</h2>
                <p class="mt-2 text-gray-600 max-w-3xl mx-auto">You've received two ranks, which can be confusing. Here's what they mean and, most importantly, which one is the key to your admission.</p>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <div class="bg-white rounded-lg shadow-lg p-6 text-center flex flex-col justify-center border-b-4 border-gray-300">
                    <h3 class="text-lg font-semibold text-gray-500">Your Input Common Merit Rank (CMR)</h3>
                    <p id="display-cmr" class="text-6xl font-extrabold my-4 text-gray-700">-</p>
                    <p class="text-sm text-gray-600">This is your overall rank among all test-takers nationwide. While it shows your general performance, it's not the primary factor for your admission due to your category status.</p>
                </div>
                <div class="bg-white rounded-lg shadow-lg p-6 text-center flex flex-col justify-center border-b-4" style="border-color: #0096C7;">
                    <h3 class="text-lg font-semibold" style="color: #004AAD;">Your Input Category Rank <span class="bg-blue-100 text-blue-800 text-xs font-semibold mr-2 px-2.5 py-0.5 rounded-full ml-2">YOUR KEY</span></h3>
                    <p id="display-category-rank" class="text-6xl font-extrabold my-4" style="color: #004AAD;">-</p>
                    <p class="text-sm text-gray-600">This is your rank within your specific reservation category (e.g., OBC, SC, ST). This is the critical number that will determine your admission to a reserved seat.</p>
                </div>
            </div>
        </section>
        
        <section id="landscape" class="mb-12">
            <div class="text-center mb-8">
                <h2 class="text-2xl md:text-4xl font-bold" style="color: #004AAD;">The NIFT B.Des Landscape</h2>
                <p class="mt-2 text-gray-600 max-w-3xl mx-auto">A total of 3,218 B.Des seats are available across all NIFT campuses. Here's how they are distributed by specialization and category reservation.</p>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <div class="bg-white rounded-lg shadow-lg p-6">
                    <h3 class="text-xl font-bold text-center mb-4">B.Des Seats by Specialization (2025)</h3>
                    <div class="chart-container h-80 md:h-96">
                        <canvas id="specializationChart"></canvas>
                    </div>
                    <p class="text-xs text-center text-gray-500 mt-4">This chart shows the total national seat count for each B.Des program. Fashion Communication and Fashion Design have the highest number of seats.</p>
                </div>
                <div class="bg-white rounded-lg shadow-lg p-6">
                    <h3 class="text-xl font-bold text-center mb-4">Seat Reservation Policy</h3>
                     <div class="chart-container h-80 md:h-96">
                        <canvas id="reservationChart"></canvas>
                    </div>
                    <p class="text-xs text-center text-gray-500 mt-4">NIFT reserves seats for various categories as per government norms. Your Category Rank means you are competing within a dedicated portion of these seats, not against the entire pool of applicants.</p>
                </div>
            </div>

            <!-- Updated Section: B.Des Specialization Details with Dropdown -->
            <div class="mt-12 bg-white rounded-lg shadow-lg p-6">
                <h3 class="text-2xl font-bold text-center mb-6" style="color: #004AAD;">B.Des Specializations at a Glance</h3>
                <div class="flex justify-center mb-6">
                    <label for="department-select" class="block mb-2 text-sm font-medium text-gray-900 mr-4 mt-2">Select a Department:</label>
                    <select id="department-select" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full max-w-xs p-2.5">
                        <!-- Options will be dynamically loaded here -->
                    </select>
                </div>
                <div id="department-details" class="border rounded-lg p-4 bg-blue-50 text-blue-800">
                    <h4 id="department-title" class="font-bold text-lg mb-2 flex items-center"></h4>
                    <p id="department-description" class="text-sm text-gray-700"></p>
                </div>
                <p class="text-sm text-center text-gray-600 mt-4">Choose a specialization from the dropdown to learn more about its focus area.</p>
            </div>
        </section>

        <section id="prospects" class="mb-12">
            <div class="text-center mb-8">
                <h2 class="text-2xl md:text-4xl font-bold" style="color: #004AAD;">Your Admission Prospects: A Data Deep Dive
                    <span class="info-tooltip">
                        <svg class="w-6 h-6 inline-block text-blue-500 hover:text-blue-700" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                        <span class="tooltiptext">
                            <p class="font-bold mb-1">How to Read This Chart:</p>
                            <p>- The dashed red line represents your input Category Rank. </p>
                            <p>- Each bar shows the simulated closing rank for a specific course and category.</p>
                            <p>- If a bar extends to the right (higher rank value) beyond your dashed line, it indicates a good chance of admission for that program and category, as your rank is better than the simulated cut-off.</p>
                            <p>- If your line is to the right of a bar, it means your rank is higher than the simulated cut-off, making admission for that combination less likely.</p>
                            <p>- Use the filters above to refine the data for a specific campus, year, or category.</p>
                            <p class="mt-2 text-yellow-300">Remember: All data shown here is based on the 2024 closing ranks you provided. For General, SC, ST, and PwD categories, if specific data was not provided, **simulated placeholder values are used** to illustrate chart functionality. Actual NIFT cutoffs vary.</p>
                        </span>
                    </span>
                </h2>
                <p class="mt-2 text-gray-600 max-w-3xl mx-auto">Input your ranks below to see how they stack up against the 2024 closing ranks for various categories. Use the campus and category selectors to explore different NIFT locations and data.</p>
            </div>
            <div class="bg-white rounded-lg shadow-lg p-6">
                <div class="flex flex-wrap justify-center gap-4 mb-6">
                    <div>
                        <label for="cmr-input" class="block mb-2 text-sm font-medium text-gray-900">Your Common Merit Rank (CMR):</label>
                        <input type="number" id="cmr-input" value="" min="1" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5">
                    </div>
                    <div>
                        <label for="category-rank-input" class="block mb-2 text-sm font-medium text-gray-900">Your Category Rank:</label>
                        <input type="number" id="category-rank-input" value="" min="0" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5">
                    </div>
                    <div>
                        <label for="campus-select" class="block mb-2 text-sm font-medium text-gray-900">Select a Campus:</label>
                        <select id="campus-select" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5">
                            <option selected value="Bengaluru">NIFT Bengaluru</option>
                            <option value="Bhopal">NIFT Bhopal</option>
                            <option value="Bhubaneswar">NIFT Bhubaneswar</option>
                            <option value="Chennai">NIFT Chennai</option>
                            <option value="Daman">NIFT Daman</option>
                            <option value="Delhi">NIFT Delhi</option>
                            <option value="Gandhinagar">NIFT Gandhinagar</option>
                            <option value="Hyderabad">NIFT Hyderabad</option>
                            <option value="Jodhpur">NIFT Jodhpur</option>
                            <option value="Kangra">NIFT Kangra</option>
                            <option value="Kannur">NIFT Kannur</option>
                            <option value="Kolkata">NIFT Kolkata</option>
                            <option value="Mumbai">NIFT Mumbai</option>
                            <option value="New Delhi">NIFT New Delhi</option>
                            <option value="Panchkula">NIFT Panchkula</option>
                            <option value="Patna">NIFT Patna</option>
                            <option value="Raebareli">NIFT Raebareli</option>
                            <option value="Shillong">NIFT Shillong</option>
                            <option value="Srinagar">NIFT Srinagar</option>
                            <option value="Varanasi">NIFT Varanasi</option>
                        </select>
                    </div>
                    <div>
                        <label for="year-select" class="block mb-2 text-sm font-medium text-gray-900">Select Year (Data from):</label>
                        <select id="year-select" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5">
                            <option selected value="2024">2024</option>
                        </select>
                    </div>
                     <div>
                        <label for="program-select" class="block mb-2 text-sm font-medium text-gray-900">Select B.Des Program:</label>
                        <select id="program-select" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5">
                            <!-- Options will be dynamically loaded here -->
                        </select>
                    </div>
                     <div>
                        <label for="category-filter-select" class="block mb-2 text-sm font-medium text-gray-900">Select Category to View:</label>
                        <select id="category-filter-select" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5">
                            <option selected value="All">All Categories</option>
                            <option value="General">General</option>
                            <option value="OBC">OBC</option>
                            <option value="SC">SC</option>
                            <option value="ST">ST</option>
                            <option value="EWS">EWS</option>
                            <option value="PwD">PwD</option>
                        </select>
                    </div>
                     <div>
                        <label for="applicant-category-select" class="block mb-2 text-sm font-medium text-gray-900">Your Actual Category (for analysis):</label>
                        <select id="applicant-category-select" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5">
                            <option selected value="OBC">OBC</option>
                            <option value="General">General</option>
                            <option value="SC">SC</option>
                            <option value="ST">ST</option>
                            <option value="EWS">EWS</option>
                            <option value="PwD">PwD</option>
                        </select>
                    </div>
                    <button id="update-ranks-button" class="mt-auto px-5 py-2.5 text-sm font-medium text-white bg-blue-700 rounded-lg hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300">Update Chart</button>
                </div>
                <div id="summary-statistics" class="bg-blue-50 p-4 rounded-lg text-sm mb-6 text-gray-700 hidden">
                    <p class="font-semibold mb-1">Summary for NIFT <span id="summary-campus">Bengaluru</span> (<span id="summary-year">2024</span>):</p>
                    <p>- Lowest Closing Rank (<span id="summary-lowest-category">General</span>): <span id="summary-lowest-rank">-</span></p>
                    <p>- Highest Closing Rank (<span id="summary-highest-category">ST</span>): <span id="summary-highest-rank">-</span></p>
                </div>
                <div class="chart-container">
                    <canvas id="cutoffChart"></canvas>
                </div>
                <p id="chart-explanation" class="text-sm text-center text-gray-600 mt-4">The red dashed line shows your **effective rank for analysis** (<span id="current-category-rank">-</span>). This rank is determined by your "Actual Category" selection (e.g., Common Merit Rank for General, Category Rank for others). If a bar representing a specific category and course extends past this line, it means the closing rank for that category in the selected year was higher than your effective rank, indicating a strong chance of admission for that specific program and category. For categories where specific data was not provided, **simulated placeholder values are used** to illustrate chart functionality. Always refer to official NIFT sources for precise cut-off information.</p>
                <div id="chance-indicator" class="mt-6 p-4 rounded-lg text-center text-lg font-semibold" style="background-color: #E0F7FA; color: #00796B;">
                    <p><span id="chance-message">Update the chart to see your admission prospects!</span></p>
                </div>
            </div>
        </section>

        <section id="trend-analysis" class="mb-12">
            <div class="text-center mb-8">
                <h2 class="text-2xl md:text-4xl font-bold" style="color: #004AAD;">Category & Course Rank Trend Over Years</h2>
                <p class="mt-2 text-gray-600 max-w-3xl mx-auto">Select a specific B.Des program and category to visualize how closing ranks have changed for the year 2024 at your chosen campus.</p>
            </div>
            <div class="bg-white rounded-lg shadow-lg p-6">
                <div class="flex flex-wrap justify-center gap-4 mb-6">
                    <div>
                        <label for="trend-campus-select" class="block mb-2 text-sm font-medium text-gray-900">Select Campus:</label>
                        <select id="trend-campus-select" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5">
                            <option selected value="Bengaluru">NIFT Bengaluru</option>
                            <option value="Bhopal">NIFT Bhopal</option>
                            <option value="Bhubaneswar">NIFT Bhubaneswar</option>
                            <option value="Chennai">NIFT Chennai</option>
                            <option value="Daman">NIFT Daman</option>
                            <option value="Delhi">NIFT Delhi</option>
                            <option value="Gandhinagar">NIFT Gandhinagar</option>
                            <option value="Hyderabad">NIFT Hyderabad</option>
                            <option value="Jodhpur">NIFT Jodhpur</option>
                            <option value="Kangra">NIFT Kangra</option>
                            <option value="Kannur">NIFT Kannur</option>
                            <option value="Kolkata">NIFT Kolkata</option>
                            <option value="Mumbai">NIFT Mumbai</option>
                            <option value="New Delhi">NIFT New Delhi</option>
                            <option value="Panchkula">NIFT Panchkula</option>
                            <option value="Patna">NIFT Patna</option>
                            <option value="Raebareli">NIFT Raebareli</option>
                            <option value="Shillong">NIFT Shillong</option>
                            <option value="Srinagar">NIFT Srinagar</option>
                            <option value="Varanasi">NIFT Varanasi</option>
                        </select>
                    </div>
                    <div>
                        <label for="trend-program-select" class="block mb-2 text-sm font-medium text-gray-900">Select B.Des Program:</label>
                        <select id="trend-program-select" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5">
                            <!-- Options will be dynamically loaded based on campus -->
                        </select>
                    </div>
                    <div>
                        <label for="trend-category-select" class="block mb-2 text-sm font-medium text-gray-900">Select Category:</label>
                        <select id="trend-category-select" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5">
                            <option selected value="OBC">OBC</option>
                            <option value="General">General</option>
                            <option value="SC">SC</option>
                            <option value="ST">ST</option>
                            <option value="EWS">EWS</option>
                            <option value="PwD">PwD</option>
                        </select>
                    </div>
                    <button id="update-trend-button" class="mt-auto px-5 py-2.5 text-sm font-medium text-white bg-blue-700 rounded-lg hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300">Show Trend</button>
                </div>
                <div class="chart-container">
                    <canvas id="trendChart"></canvas>
                </div>
                 <p class="text-sm text-center text-gray-600 mt-4">This line chart illustrates the closing rank for the selected B.Des program and category in 2024. As only 2024 data is available, the "trend" will be a single point for now. For General, SC, ST, and PwD categories, if specific data was not provided, **simulated placeholder values are used** to illustrate chart functionality. Always refer to official NIFT sources for precise cut-off information.</p>
            </div>
        </section>


        <section id="counseling" class="mb-12">
            <div class="text-center mb-8">
                <h2 class="text-2xl md:text-4xl font-bold" style="color: #004AAD;">The Path to Admission</h2>
                <p class="mt-2 text-gray-600 max-w-3xl mx-auto">The NIFT counseling process is a multi-step journey. Here's a clear roadmap of what to expect.</p>
            </div>
            <div class="bg-white rounded-lg shadow-lg p-6 md:p-8">
                <div class="max-w-3xl mx-auto">
                    <div class="flowchart-step mb-12">
                        <div class="flowchart-step-icon text-white" style="background-color: #004AAD;">📝</div>
                        <div class="ml-4">
                            <h4 class="font-bold text-lg">1. Register & Fill Choices</h4>
                            <p class="text-gray-600 text-sm">Log in to the NIFT portal, register for counseling, and carefully prioritize your preferred campuses and B.Des programs.</p>
                        </div>
                        <div class="flowchart-line" style="background-color: #CAF0F8;"></div>
                    </div>
                    <div class="flowchart-step mb-12">
                        <div class="flowchart-step-icon text-white" style="background-color: #0096C7;">📂</div>
                        <div class="ml-4">
                            <h4 class="font-bold text-lg">2. Upload & Verify Documents</h4>
                            <p class="text-gray-600 text-sm">Upload scanned copies of required documents, ensuring legibility and proper file size (50 KB to 250 KB per document). Digilocker documents are accepted for Class 10/12 mark sheets. Remember to self-attest all copies.</p>
                            
                            <details class="bg-gray-100 rounded-lg p-3 mt-4 text-sm text-gray-700">
                                <summary class="font-semibold text-gray-800">Detailed List of Required Documents & Annexures</summary>
                                <ul class="list-disc list-inside space-y-1 mt-2">
                                    <li>Self-Attested copy of **10th class certificate** (Mandatory)</li>
                                    <li>Self-Attested copy of **12th class mark sheet** OR **Undertaking (Annexure-I)**, in case the result is not declared by the Board (Mandatory, provisional admission given with Undertaking)</li>
                                    <li>Self-Attested copy of **12th class certificate** (as per 10+2 pattern from recognized board, or equivalent exams like National Open School, GCE/IB, or Undertaking (Annexure-I) if result not declared) (Mandatory)</li>
                                    <li>Self-Attested copy of **valid SC certificate** of the candidate (if applicable) (Mandatory)</li>
                                    <li>Self-Attested copy of **valid ST certificate** of the candidate (if applicable) (Mandatory)</li>
                                    <li>Self-Attested copy of **PwD certificate and UDID Card** issued by the Department of Empowerment of Person with Disability, if applicable (Mandatory)</li>
                                    <li>Self-Attested copy of **valid OBC (NCL) certificate** in prescribed format (if applicable). Caste must be in Central list. (Certificate Issued **not earlier than 1st April, 2023**) (Mandatory)</li>
                                    <li>Self-Attested copy of **valid EWS certificate** in prescribed format in the name of the candidate (if applicable). (Valid for the year **2024-25**) (Mandatory)</li>
                                    <li>Self-Attested copy of **12th class School Leaving Certificate OR 11th class marksheet OR provisional certificate from Principal of the school OR School ID Card of class XII with details of Academic year clearly mentioned OR Kashmiri Migrant Certificate**. (Mandatory, if candidate is taking domicile seat)</li>
                                    <li>Photocopy of first & last page of the **passport of the sponsoring person** (for NRI Sponsored) (Mandatory)</li>
                                    <li>Copy of the **valid visa / work permit of the sponsoring NRI/Foreign National/OCI/PIO** (for NRI Sponsored) (Mandatory)</li>
                                </ul>
                                <h5 class="font-semibold mt-4 mb-2">Mandatory Annexures:</h5>
                                <ul class="list-disc list-inside space-y-1">
                                    <li>**Annexure-I:** For candidate seeking provisional admission (if Class 12 result is pending)</li>
                                    <li>**Annexure-II:** Undertaking for Anti-ragging</li>
                                    <li>**Annexure-III:** Undertaking to be signed by sponsoring NRI/Foreign National/OCI/PIO</li>
                                    <li>**Annexure-IV:** Undertaking for Refund of fees</li>
                                    <li>**Annexure-V:** Medical Fitness Certificate (Must be filled by a **GOVT DOCTOR** and stamped)</li>
                                </ul>
                                <p class="mt-2 text-xs text-red-700">**Important:** If you don't have your Class 12 Passing Certificate, submit Annexure-I but ensure you apply for it from your school immediately as it will be required later. For Migration Certificate, if unavailable, upload your Class 11 marksheet.</p>
                            </details>
                        </div>
                        <div class="flowchart-line" style="background-color: #CAF0F8;"></div>
                    </div>
                    <div class="flowchart-step mb-12">
                        <div class="flowchart-step-icon text-white" style="background-color: #0096C7;">💳</div>
                         <div class="ml-4">
                             <h4 class="font-bold text-lg">3. Pay Counselling Fee</h4>
                             <p class="text-gray-600 text-sm">Pay the non-refundable counseling fee of <span class="font-bold">₹9,300</span> to lock your choices and complete your registration.</p>
                         </div>
                        <div class="flowchart-line" style="background-color: #CAF0F8;"></div>
                    </div>
                    <div class="flowchart-step mb-12">
                        <div class="flowchart-step-icon text-white" style="background-color: #48CAE4;">🪑</div>
                        <div class="ml-4">
                            <h4 class="font-bold text-lg">4. Seat Allotment</h4>
                            <p class="text-gray-600 text-sm">Seats are allotted based on your rank and choices. You'll be notified via email if you get a seat in any of the multiple rounds.</p>
                        </div>
                         <div class="flowchart-line" style="background-color: #CAF0F8;"></div>
                    </div>
                     <div class="flowchart-step">
                        <div class="flowchart-step-icon text-white" style="background-color: #ADE8F4;">✅</div>
                        <div class="ml-4">
                            <h4 class="font-bold text-lg">5. Accept Your Seat</h4>
                            <p class="text-sm text-gray-600">If allotted a seat, you must pay the admission fee of <span class="font-bold">₹1,83,200</span> to confirm. You can choose to 'Freeze' your seat or 'Float' to be considered for higher preferences in the next round.</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        
        <section id="strategy" class="mb-12">
            <div class="text-center mb-8">
                 <h2 class="text-2xl md:text-4xl font-bold" style="color: #004AAD;">Your Strategic Action Plan</h2>
                <p class="mt-2 text-gray-600 max-w-3xl mx-auto">Your rank is strong, but a smart strategy is key. Here's what to do next to maximize your chances.</p>
            </div>
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
                <div class="bg-white rounded-lg shadow-lg p-6">
                    <h4 class="font-bold text-lg mb-2 flex items-center"><span class="text-2xl mr-3">🔬</span>Research</h4>
                    <p class="text-sm text-gray-600">Dive deep into the previous years' closing ranks for your specific category across all 19 NIFT campuses.</p>
                </div>
                <div class="bg-white rounded-lg shadow-lg p-6">
                    <h4 class="font-bold text-lg mb-2 flex items-center"><span class="text-2xl mr-3">🎯</span>Prioritize</h4>
                    <p class="text-sm text-gray-600">Create a balanced choice list with a mix of ambitious dream choices and realistic, safe options where your rank is well within the cut-off.</p>
                </div>
                 <div class="bg-white rounded-lg shadow-lg p-6">
                    <h4 class="font-bold text-lg mb-2 flex items-center"><span class="text-2xl mr-3">📋</span>Prepare</h4>
                    <p class="text-sm text-gray-600">Gather all your documents now. Ensure your category certificate is valid and meets NIFT's date requirements.</p>
                </div>
                <div class="bg-white rounded-lg shadow-lg p-6">
                    <h4 class="font-bold text-lg mb-2 flex items-center"><span class="text-2xl mr-3">🔄</span>Stay Updated</h4>
                    <p class="text-sm text-gray-600">Regularly check the official NIFT website for counseling dates and announcements. Don't miss any deadlines!</p>
                </div>
            </div>
        </section>

    </main>

    <footer class="bg-white mt-12 py-6">
        <div class="container mx-auto px-6 text-center text-gray-500 text-sm">
            <p>&copy; 2025 NIFT Admission Analysis. This infographic is for informational purposes based on simulated data.</p>
            <p class="mt-1">Always refer to the official NIFT website for final information.</p>
        </div>
    </footer>
    
<script>
    // Utility function to wrap long labels for better chart readability
    function wrapLabels(label, maxWidth) {
        if (typeof label !== 'string' || label.length <= maxWidth) {
            return label;
        }
        const words = label.split(' ');
        const lines = [];
        let currentLine = '';
        words.forEach(word => {
            if ((currentLine + ' ' + word).trim().length > maxWidth) {
                lines.push(currentLine.trim());
                currentLine = word;
            } else {
                currentLine = (currentLine + ' ' + word).trim();
            }
        });
        if (currentLine) {
            lines.push(currentLine.trim());
        }
        return lines;
    }

    // Callback for tooltip title to handle wrapped labels
    const tooltipTitleCallback = (tooltipItems) => {
        const item = tooltipItems[0];
        let label = item.chart.data.labels[item.dataIndex];
        return Array.isArray(label) ? label.join(' ') : label;
    };
    
    // Common options for charts
    const commonChartOptions = {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
            legend: {
                position: 'bottom',
                labels: {
                    padding: 20,
                    font: {
                        size: 12
                    }
                }
            },
            tooltip: {
                callbacks: {
                    title: tooltipTitleCallback
                }
            }
        }
    };
    
    // Data for Specialization Distribution Chart (Doughnut)
    const specializationData = {
        labels: ['Accessory Design', 'Fashion Comm.', 'Fashion Design', 'Knitwear Design', 'Leather Design', 'Textile Design', 'Fashion Interior'].map(l => wrapLabels(l, 16)),
        datasets: [{
            label: 'Total Seats',
            data: [596, 719, 719, 310, 152, 681, 41],
            backgroundColor: ['#004AAD', '#0096C7', '#48CAE4', '#ADE8F4', '#CAF0F8', '#023E8A', '#0077B6'], // Using more shades of blue
            borderColor: '#ffffff',
            borderWidth: 2
        }]
    };
    new Chart(document.getElementById('specializationChart'), {
        type: 'doughnut',
        data: specializationData,
        options: commonChartOptions
    });

    // Data for Reservation Policy Chart (Pie)
    const reservationData = {
        labels: ['OBC-NCL', 'SC', 'ST', 'GEN-EWS', 'General/Open'].map(l => wrapLabels(l, 16)),
        datasets: [{
            label: 'Reservation %',
            data: [27, 15, 7.5, 10, 40.5],
            backgroundColor: ['#FF5733', '#33FF57', '#0096C7', '#FFC300', '#A020F0'], // High contrast colors
            borderColor: '#ffffff',
            borderWidth: 2
        }]
    };
    new Chart(document.getElementById('reservationChart'), {
        type: 'pie',
        data: reservationData,
        options: commonChartOptions
    });

    // Simulated Cut-off Data for various campuses, years, and categories
    // This data has been enhanced with simulated values for General, SC, ST, and PwD where original data was not available,
    // to ensure all categories display on the chart. These are illustrative and not actual historical data.
    const cutoffData = {
        'Bengaluru': {
            '2024': {
                'Fashion Design': { "EWS": 508, "OBC": 1020, "General": 250, "SC": 2100, "ST": 3100, "PwD": 7500 },
                'Fashion Comm.': { "EWS": 623, "OBC": 520, "General": 150, "SC": 2200, "ST": 2500, "PwD": 7800 },
                'Accessory Design': { "EWS": 1132, "OBC": 895, "General": 400, "SC": 4500, "ST": 7500, "PwD": 8000 },
                'Knitwear Design': { "EWS": 2622, "OBC": 2315, "General": 1000, "SC": 5600, "ST": 7000, "PwD": 8500 },
                'Textile Design': { "EWS": 2905, "OBC": 2260, "General": 700, "SC": 4000, "ST": 7400, "PwD": 8200 }
            }
        },
        'Bhopal': {
            '2024': {
                'Fashion Communication': { "EWS": 1972, "OBC": 1724, "General": 1500, "SC": 6000, "ST": 8000, "PwD": 10500 },
                'Accessory Design': { "EWS": 4293, "OBC": 1923, "General": 3000, "SC": 8000, "ST": 9000, "PwD": 11000 },
                'Fashion Design': { "EWS": 4380, "OBC": 2794, "General": 2500, "SC": 6000, "ST": 7500, "PwD": 10000 },
                'Knitwear Design': { "EWS": 6026, "OBC": 3571, "General": 3000, "SC": 7000, "ST": 8500, "PwD": 11500 },
                'Textile Design': { "EWS": 6081, "OBC": 3167, "General": 2800, "SC": 6500, "ST": 8200, "PwD": 11200 }
            }
        },
        'Bhubaneswar': {
            '2024': {
                'Fashion Communication': { "EWS": 1607, "OBC": 1219, "General": 1000, "SC": 5500, "ST": 7000, "PwD": 9500 },
                'Accessory Design': { "EWS": 5253, "OBC": 2310, "General": 2000, "SC": 7000, "ST": 8500, "PwD": 10000 },
                'Fashion Design': { "EWS": 5406, "OBC": 2196, "General": 1800, "SC": 6000, "ST": 7500, "PwD": 9000 },
                'Textile Design': { "EWS": 6666, "OBC": 3629, "General": 3000, "SC": 7500, "ST": 9000, "PwD": 10500 }
            }
        },
        'Chennai': {
            '2024': {
                'Fashion Communication': { "EWS": 1083, "OBC": 485, "General": 200, "SC": 4000, "ST": 5000, "PwD": 9000 },
                'Knitwear Design': { "EWS": 2491, "OBC": 1623, "General": 1200, "SC": 7000, "ST": 7500, "PwD": 9800 },
                'Accessory Design': { "EWS": 3056, "OBC": 1096, "General": 800, "SC": 8000, "ST": 8500, "PwD": 10000 },
                'Fashion Design': { "EWS": 3530, "OBC": 693, "General": 400, "SC": 3500, "ST": 3200, "PwD": 8800 },
                'Textile Design': { "EWS": 4798, "OBC": 1848, "General": 1500, "SC": 7000, "ST": 8000, "PwD": 9500 },
                'Leather Design': { "EWS": 5205, "OBC": 2120, "General": 2000, "SC": 8500, "ST": 9000, "PwD": 10500 }
            }
        },
        'Daman': {
            '2024': {
                'Textile Design': { "EWS": 5738, "OBC": 2749, "General": 3000, "SC": 7000, "ST": 8500, "PwD": 11000 }
            }
        },
        'Gandhinagar': {
            '2024': {
                'Fashion Communication': { "EWS": 764, "OBC": 437, "General": 300, "SC": 4500, "ST": 3000, "PwD": 8800 },
                'Fashion Design': { "EWS": 1105, "OBC": 725, "General": 350, "SC": 1700, "ST": 1300, "PwD": 8500 },
                'Accessory Design': { "EWS": 3008, "OBC": 958, "General": 700, "SC": 3500, "ST": 4500, "PwD": 8600 },
                'Textile Design': { "EWS": 3257, "OBC": 2297, "General": 1000, "SC": 3300, "ST": 3800, "PwD": 8700 }
            }
        },
        'Hyderabad': {
            '2024': {
                'Fashion Communication': { "EWS": 1170, "OBC": 383, "General": 400, "SC": 4800, "ST": 4100, "PwD": 9200 },
                'Fashion Design': { "EWS": 1794, "OBC": 1008, "General": 450, "SC": 2600, "ST": 3000, "PwD": 8900 },
                'Accessory Design': { "EWS": 2603, "OBC": 556, "General": 3800, "SC": 7900, "ST": 7000, "PwD": 10000 },
                'Textile Design': { "EWS": 3610, "OBC": 1655, "General": 1000, "SC": 8700, "ST": 8400, "PwD": 10400 },
                'Knitwear Design': { "EWS": 3843, "OBC": 2156, "General": 1300, "SC": 8400, "ST": 9000, "PwD": 10600 }
            }
        },
        'Jodhpur': {
            '2024': {
                'Fashion Communication': { "EWS": 1796, "OBC": 1139, "General": 1500, "SC": 6800, "ST": 8200, "PwD": 10500 },
                'Accessory Design': { "EWS": 3341, "OBC": 1685, "General": 3000, "SC": 7500, "ST": 9000, "PwD": 11000 },
                'Fashion Design': { "EWS": 5093, "OBC": 2170, "General": 3200, "SC": 6800, "ST": 8200, "PwD": 10500 },
                'Textile Design': { "EWS": 5159, "OBC": 3292, "General": 4100, "SC": 7500, "ST": 9000, "PwD": 11000 }
            }
        },
        'Kangra': {
            '2024': {
                'Fashion Communication': { "EWS": 4317, "OBC": 1116, "General": 3000, "SC": 6700, "ST": 8300, "PwD": 10500 },
                'Accessory Design': { "EWS": 4757, "OBC": 2215, "General": 3500, "SC": 7000, "ST": 8500, "PwD": 11000 },
                'Textile Design': { "EWS": 6227, "OBC": 4044, "General": 4000, "SC": 7500, "ST": 9000, "PwD": 11500 },
                'Fashion Design': { "EWS": 6081, "OBC": 2165, "General": 3100, "SC": 6200, "ST": 7800, "PwD": 10000 }
            }
        },
        'Kannur': {
            '2024': {
                'Fashion Communication': { "EWS": 3163, "OBC": 1113, "General": 2000, "SC": 5800, "ST": 7200, "PwD": 9200 },
                'Fashion Design': { "EWS": 5534, "OBC": 1633, "General": 2200, "SC": 5800, "ST": 7200, "PwD": 9200 },
                'Knitwear Design': { "EWS": 6974, "OBC": 2291, "General": 2500, "SC": 6000, "ST": 7400, "PwD": 9400 },
                'Textile Design': { "EWS": 6997, "OBC": 2513, "General": 3800, "SC": 7300, "ST": 8800, "PwD": 10300 }
            }
        },
        'Kolkata': {
            '2024': {
                'Fashion Communication': { "EWS": 421, "OBC": 758, "General": 400, "SC": 4500, "ST": 6200, "PwD": 9800 },
                'Fashion Design': { "EWS": 2003, "OBC": 835, "General": 600, "SC": 3100, "ST": 4000, "PwD": 9500 },
                'Accessory Design': { "EWS": 2993, "OBC": 1371, "General": 3000, "SC": 7000, "ST": 7800, "PwD": 11000 },
                'Textile Design': { "EWS": 4824, "OBC": 3040, "General": 2500, "SC": 9000, "ST": 5300, "PwD": 10200 },
                'Knitwear Design': { "EWS": 5396, "OBC": 3295, "General": 1700, "SC": 9000, "ST": 8500, "PwD": 10500 },
                'Leather Design': { "EWS": 7096, "OBC": 3023, "General": 3100, "SC": 6900, "ST": 7700, "PwD": 11000 }
            }
        },
        'Mumbai': {
            '2024': {
                'Textile Design': { "EWS": 5812, "OBC": 722, "General": 500, "SC": 1800, "ST": 2200, "PwD": 6500 },
                'Fashion Communication': { "EWS": 643, "OBC": 113, "General": 400, "SC": 1600, "ST": 2000, "PwD": 6200 },
                'Accessory Design': { "EWS": 851, "OBC": 501, "General": 700, "SC": 2000, "ST": 2500, "PwD": 6800 },
                'Fashion Design': { "EWS": 937, "OBC": 517, "General": 500, "SC": 1800, "ST": 2200, "PwD": 6500 },
                'Knitwear Design': { "EWS": 2429, "OBC": 1049, "General": 1400, "SC": 3000, "ST": 3500, "PwD": 7500 }
            }
        },
        'New Delhi': {
            '2024': {
                'Fashion Communication': { "EWS": 253, "OBC": 56, "General": 100, "SC": 1200, "ST": 1800, "PwD": 5500 },
                'Fashion Design': { "EWS": 442, "OBC": 178, "General": 200, "SC": 1500, "ST": 2000, "PwD": 6000 },
                'Accessory Design': { "EWS": 462, "OBC": 249, "General": 300, "SC": 2000, "ST": 2500, "PwD": 7000 },
                'Textile Design': { "EWS": 873, "OBC": 397, "General": 400, "SC": 2500, "ST": 3000, "PwD": 7500 },
                'Knitwear Design': { "EWS": 1636, "OBC": 674, "General": 700, "SC": 3000, "ST": 3500, "PwD": 8000 },
                'Leather Design': { "EWS": 1825, "OBC": 1436, "General": 900, "SC": 2500, "ST": 3000, "PwD": 7000 }
            }
        },
        'Panchkula': {
            '2024': {
                'Fashion Communication': { "EWS": 3508, "OBC": 3508, "General": 2800, "SC": 6000, "ST": 7500, "PwD": 10000 },
                'Textile Design': { "EWS": 6366, "OBC": 6366, "General": 3800, "SC": 7200, "ST": 8700, "PwD": 10500 },
                'Fashion Design': { "EWS": 5986, "OBC": 5986, "General": 2900, "SC": 6000, "ST": 7500, "PwD": 10000 }
            }
        },
        'Patna': {
            '2024': {
                'Fashion Communication': { "EWS": 1874, "OBC": 1874, "General": 1500, "SC": 6600, "ST": 8100, "PwD": 10700 },
                'Fashion Design': { "EWS": 2961, "OBC": 2961, "General": 2900, "SC": 6100, "ST": 7700, "PwD": 10200 },
                'Accessory Design': { "EWS": 4328, "OBC": 4328, "General": 3500, "SC": 7000, "ST": 8500, "PwD": 11000 },
                'Textile Design': { "EWS": 5961, "OBC": 5961, "General": 4000, "SC": 7500, "ST": 9000, "PwD": 11500 }
            }
        },
        'Raebareli': {
            '2024': {
                'Fashion Communication': { "EWS": 3267, "OBC": 3267, "General": 2800, "SC": 6200, "ST": 7900, "PwD": 10400 },
                'Accessory Design': { "EWS": 4647, "OBC": 4647, "General": 3500, "SC": 7000, "ST": 8500, "PwD": 11000 },
                'Fashion Design': { "EWS": 5767, "OBC": 5767, "General": 3100, "SC": 6300, "ST": 7900, "PwD": 10400 },
                'Leather Design': { "EWS": 7552, "OBC": 7552, "General": 4000, "SC": 7500, "ST": 9000, "PwD": 11500 }
            }
        },
        'Shillong': {
            '2024': {
                'Fashion Communication': { "EWS": 4535, "OBC": 4535, "General": 3700, "SC": 7200, "ST": 8700, "PwD": 11200 },
                'Fashion Design': { "EWS": 6081, "OBC": 6081, "General": 3500, "SC": 6900, "ST": 8400, "PwD": 10800 },
                'Accessory Design': { "EWS": 6553, "OBC": 6553, "General": 4000, "SC": 7500, "ST": 9000, "PwD": 11500 },
                'Textile Design': { "EWS": 7089, "OBC": 7089, "General": 4200, "SC": 7700, "ST": 9200, "PwD": 11700 }
            }
        },
        'Srinagar': {
            '2024': {
                'Fashion Communication': { "EWS": 4295, "OBC": 4295, "General": 3600, "SC": 7000, "ST": 8500, "PwD": 11000 },
                'Accessory Design': { "EWS": 5949, "OBC": 5949, "General": 4000, "SC": 7500, "ST": 9000, "PwD": 11500 },
                'Fashion Design': { "EWS": 6672, "OBC": 6672, "General": 3700, "SC": 7000, "ST": 8500, "PwD": 11000 },
                'Textile Design': { "EWS": 7239, "OBC": 7239, "General": 4300, "SC": 7800, "ST": 9300, "PwD": 11800 }
            }
        },
        'Varanasi': {
            '2024': {
                'Fashion Interiors': { "EWS": 4348, "OBC": 4348, "General": 3500, "SC": 6000, "ST": 7500, "PwD": 9800 },
                'Fashion Communication': { "EWS": 4765, "OBC": 4765, "General": 3800, "SC": 6900, "ST": 8400, "PwD": 10900 },
                'Fashion Design': { "EWS": 6007, "OBC": 6007, "General": 2900, "SC": 5900, "ST": 7400, "PwD": 9700 }
            }
        }
    };
    
    let cutoffChart; // Main bar chart for prospects
    let trendChart; // Line chart for multi-year trends

    // HTML elements
    const campusSelect = document.getElementById('campus-select');
    const yearSelect = document.getElementById('year-select');
    const programSelect = document.getElementById('program-select'); // Main program select
    const categoryFilterSelect = document.getElementById('category-filter-select');
    const applicantCategorySelect = document.getElementById('applicant-category-select'); // Your Actual Category dropdown
    const cmrInput = document.getElementById('cmr-input');
    const categoryRankInput = document.getElementById('category-rank-input');
    const updateRanksButton = document.getElementById('update-ranks-button');
    const displayCmr = document.getElementById('display-cmr');
    const displayCategoryRank = document.getElementById('display-category-rank');
    const currentCategoryRankSpan = document.getElementById('current-category-rank');
    const chanceIndicator = document.getElementById('chance-indicator');
    const chanceMessage = document.getElementById('chance-message');
    const summaryStatisticsDiv = document.getElementById('summary-statistics');
    const summaryCampusSpan = document.getElementById('summary-campus');
    const summaryYearSpan = document.getElementById('summary-year');
    const summaryLowestCategorySpan = document.getElementById('summary-lowest-category');
    const summaryLowestRankSpan = document.getElementById('summary-lowest-rank');
    const summaryHighestCategorySpan = document.getElementById('summary-highest-category');
    const summaryHighestRankSpan = document.getElementById('summary-highest-rank');
    const infoTooltipIcon = document.querySelector('.info-tooltip svg'); // For tooltip toggle

    // Trend chart specific elements
    const trendCampusSelect = document.getElementById('trend-campus-select');
    const trendProgramSelect = document.getElementById('trend-program-select'); // Trend program select
    const trendCategorySelect = document.getElementById('trend-category-select');
    const updateTrendButton = document.getElementById('update-trend-button');

    // Department selection elements for "Specializations at a Glance"
    const departmentSelect = document.getElementById('department-select');
    const departmentTitle = document.getElementById('department-title');
    const departmentDescription = document.getElementById('department-description');

    // Data for B.Des Specializations details
    const bdesSpecializations = {
        'Accessory Design': {
            icon: '👜',
            description: 'Explores the design and production of accessories like footwear, bags, jewelry, and lifestyle products. Combines aesthetics with functionality and market trends.'
        },
        'Fashion Communication': {
            icon: '�',
            description: 'Develops skills in fashion journalism, photography, styling, visual merchandising, and graphic design for the fashion industry. Perfect for storytellers and communicators.'
        },
        'Fashion Design': {
            icon: '👗',
            description: 'Focuses on creativity, garment construction, pattern making, and fashion illustration. Prepares students for roles as fashion designers, stylists, and merchandisers.'
        },
        'Fashion Interior': {
            icon: '🏠',
            description: 'Applies fashion principles to interior spaces, focusing on aesthetics, functionality, and trend analysis in residential and commercial design contexts.'
        },
        'Knitwear Design': {
            icon: '🧶',
            description: 'Specializes in the design, development, and production of knitted garments and products. Covers yarn technology, knitting techniques, and trend forecasting.'
        },
        'Leather Design': {
            icon: '👞',
            description: 'Focuses on the design and manufacturing of leather goods, including footwear, garments, and other leather products. Emphasizes material knowledge and craftsmanship.'
        },
        'Textile Design': {
            icon: '🧵',
            description: 'Involves the creation of designs for woven, printed, and surface-patterned textiles for fashion, interiors, and other applications. Combines art with material science.'
        }
    };


    // Category colors for charts
    const categoryColorsMap = {
        'General': '#4CAF50', 
        'OBC': '#FF5733',
        'SC': '#33FF57',
        'ST': '#0096C7',
        'EWS': '#FFC300',
        'PwD': '#A020F0'
    };

    let currentApplicantRank = 0; // Initialize global variable for the applicant's effective rank


    // --- Core Functions ---

    // Updates the displayed CMR and Category Ranks from input fields
    function updateDisplayedRanks() {
        // Use a default value of 0 or NaN if the input is empty or invalid
        const cmrValue = cmrInput.value === '' ? 0 : parseInt(cmrInput.value, 10);
        const categoryRankValue = categoryRankInput.value === '' ? 0 : parseInt(categoryRankInput.value, 10);

        displayCmr.textContent = cmrValue === 0 ? '-' : cmrValue;
        displayCategoryRank.textContent = categoryRankValue === 0 ? '-' : categoryRankValue;

        const selectedApplicantCategory = applicantCategorySelect.value;
        // Dynamically choose which rank to use based on the "Your Actual Category" selection
        if (selectedApplicantCategory === 'General') {
            currentApplicantRank = cmrValue;
            // Update the span to clearly indicate which rank is being used for analysis
            currentCategoryRankSpan.textContent = cmrValue === 0 ? '-' : `${cmrValue} (CMR)`; 
        } else {
            currentApplicantRank = categoryRankValue;
            // Update the span to clearly indicate which rank is being used for analysis
            currentCategoryRankSpan.textContent = categoryRankValue === 0 ? '-' : `${categoryRankValue} (Category)`; 
        }
    }

    // Calculates and displays admission chances
    function updateChanceIndicator(campus, year, applicantCategory, applicantRank, selectedProgram) {
        const campusYearData = cutoffData[campus]?.[year];
        if (!campusYearData || !applicantCategory || applicantRank === 0) { // Added check for applicantRank being 0
            chanceMessage.textContent = "Please enter your ranks and select a campus, year, and your actual category to get an assessment.";
            chanceIndicator.style.backgroundColor = '#E0F7FA'; // Default light blue
            chanceIndicator.style.color = '#00796B'; // Default dark cyan
            return;
        }

        let programsToAnalyze = [];
        if (selectedProgram === "All Programs") {
            // Filter programs to analyze to only those present in the data for this campus/year
            programsToAnalyze = Object.keys(campusYearData); 
        } else {
            // Only analyze the specific selected program
            if (campusYearData[selectedProgram]) {
                programsToAnalyze.push(selectedProgram);
            }
        }

        let favorablePrograms = [];
        let borderlinePrograms = [];
        let unfavorablePrograms = [];

        programsToAnalyze.forEach(program => {
            // Use the applicantCategory to fetch the correct cutoff for the analysis
            if (campusYearData[program] && campusYearData[program][applicantCategory] !== undefined) {
                const cutoff = campusYearData[program][applicantCategory];
                if (cutoff === null) return; // Skip if no data for this specific category/program

                if (applicantRank <= cutoff) { // Rank is better than or equal to cutoff
                    if (cutoff - applicantRank <= 100 && cutoff - applicantRank >= 0) { // Within 100 ranks of cutoff
                         borderlinePrograms.push(program);
                    } else if (applicantRank < cutoff) { // Strictly better rank
                        favorablePrograms.push(program);
                    } else { // Equal rank, treat as borderline
                        borderlinePrograms.push(program);
                    }
                } else { // Rank is worse than cutoff
                    unfavorablePrograms.push(program);
                }
            }
        });
        
        let message = "";
        let bgColor = '';
        let textColor = '';

        if (favorablePrograms.length > 0) {
            message = `Based on your effective rank of ${applicantRank} (${applicantCategory}) and 2024 data for ${campus}, your chances are **High** for programs like: ${favorablePrograms.slice(0, 2).join(', ')}${favorablePrograms.length > 2 ? ' and more.' : '.'}`;
            bgColor = '#D4EDDA'; // Light Green
            textColor = '#155724'; // Dark Green
        } else if (borderlinePrograms.length > 0) {
            message = `Based on your effective rank of ${applicantRank} (${applicantCategory}) and 2024 data for ${campus}, your chances are **Moderate/Borderline** for programs like: ${borderlinePrograms.slice(0, 2).join(', ')}${borderlinePrograms.length > 2 ? ' and more.' : '.'} Consider 'Float' during counseling if allotted.`;
            bgColor = '#FFF3CD'; // Light Yellow
            textColor = '#856404'; // Dark Yellow
        } else {
            message = `Based on your effective rank of ${applicantRank} (${applicantCategory}) and 2024 data for ${campus}, your chances are **Low/Unlikely** for any programs at this campus.`;
            bgColor = '#F8D7DA'; // Light Red
            textColor = '#721C24'; // Dark Red
        }
        chanceMessage.innerHTML = message;
        chanceIndicator.style.backgroundColor = bgColor;
        chanceIndicator.style.color = textColor;
        summaryStatisticsDiv.style.display = 'block';
    }

    // Populates the program dropdown based on the selected campus and year
    function populateProgramDropdown() {
        const selectedCampus = campusSelect.value;
        const selectedYear = yearSelect.value; // Will always be 2024 now
        const campusYearData = cutoffData[selectedCampus]?.[selectedYear];

        programSelect.innerHTML = '<option value="All Programs">All Programs</option>'; // Always add "All Programs"
        if (campusYearData) {
            const programs = Object.keys(campusYearData);
            programs.forEach(program => {
                const option = document.createElement('option');
                option.value = program;
                option.textContent = program;
                programSelect.appendChild(option);
            });
        }
    }

    // Updates chart for prospects section
    function createCutoffChart(campus, selectedYear, selectedCategoryFilter) {
        const campusYearData = cutoffData[campus]?.[selectedYear];
        if (!campusYearData) {
            if (cutoffChart) cutoffChart.destroy();
            chanceMessage.textContent = `No closing rank data available for ${campus} in ${selectedYear}.`;
            chanceIndicator.style.backgroundColor = '#E0F7FA'; // Default light blue
            chanceIndicator.style.color = '#00796B'; // Default dark cyan
            summaryStatisticsDiv.style.display = 'none';
            return;
        }

        const chartLabels = [];
        const datasets = [];
        const allCategories = ['General', 'OBC', 'SC', 'ST', 'EWS', 'PwD'];
        const categoryColors = {
            'General': '#4CAF50', // Green
            'OBC': '#FF5733',    // Orange-Red
            'SC': '#33FF57',     // Bright Green
            'ST': '#0096C7',     // Sky Blue
            'EWS': '#FFC300',    // Gold
            'PwD': '#A020F0'     // Purple
        };

        const programsInCampus = Object.keys(campusYearData);
        programsInCampus.forEach(program => {
            chartLabels.push(wrapLabels(program, 16)); // Use program name as label
        });

        if (selectedCategoryFilter === 'All') {
            allCategories.forEach(category => {
                const dataForCategory = programsInCampus.map(program => campusYearData[program][category] || null);
                if (dataForCategory.some(d => d !== null)) { // Only add dataset if it has data
                    datasets.push({
                        label: `${category} Closing Rank`,
                        data: dataForCategory,
                        backgroundColor: categoryColors[category] || '#CCCCCC', // Default grey for unknown
                        borderColor: '#ffffff',
                        borderWidth: 1
                    });
                }
            });
        } else {
            const dataForSelectedCategory = programsInCampus.map(program => campusYearData[program][selectedCategoryFilter] || null);
            if (dataForSelectedCategory.some(d => d !== null)) {
                datasets.push({
                    label: `${selectedCategoryFilter} Closing Rank`,
                    data: dataForSelectedCategory,
                    backgroundColor: categoryColors[selectedCategoryFilter] || '#CCCCCC',
                    borderColor: '#ffffff',
                    borderWidth: 1
                });
            } else {
                 // Handle case where specific category has no data for the selected campus/year
                if (cutoffChart) cutoffChart.destroy();
                chanceMessage.textContent = `No specific closing rank data for ${selectedCategoryFilter} at ${campus} in ${selectedYear}. Displaying simulated data if available.`;
                chanceIndicator.style.backgroundColor = '#F8D7DA';
                chanceIndicator.style.color = '#721C24';
                summaryStatisticsDiv.style.display = 'none';
                return;
            }
        }
        
        const chartData = {
            labels: chartLabels,
            datasets: datasets
        };
        
        const chartConfig = {
            type: 'bar',
            data: chartData,
            options: {
                responsive: true,
                maintainAspectRatio: false,
                indexAxis: 'y', // Horizontal bars
                scales: {
                    x: {
                        beginAtZero: true,
                        title: {
                            display: true,
                            text: `Closing Rank (${selectedYear})`
                        }
                    },
                    y: {
                        ticks: {
                            callback: function(value, index, ticks) {
                                return Array.isArray(this.getLabelForValue(value)) ? this.getLabelForValue(value).join(' ') : this.getLabelForValue(value);
                            }
                        }
                    }
                },
                plugins: {
                    title: {
                        display: true,
                        text: `B.Des Closing Ranks for NIFT ${campus} (${selectedYear})`,
                        font: { size: 16 }
                    },
                    legend: {
                        position: 'top',
                    },
                    tooltip: {
                        callbacks: {
                           title: tooltipTitleCallback,
                           label: function(tooltipItem) {
                                return tooltipItem.dataset.label + ': ' + (tooltipItem.raw !== null ? tooltipItem.raw : 'N/A');
                            }
                        }
                    },
                    annotation: {
                        annotations: {
                            line1: {
                                type: 'line',
                                xMin: currentApplicantRank,
                                xMax: currentApplicantRank,
                                borderColor: 'rgb(255, 99, 132)',
                                borderWidth: 2,
                                borderDash: [6, 6],
                                label: {
                                    enabled: true,
                                    content: `Your Rank: ${currentApplicantRank}`,
                                    position: 'start',
                                    backgroundColor: 'rgba(255, 99, 132, 0.8)',
                                    color: 'white',
                                    font: { size: 12 }
                                }
                            }
                        }
                    }
                }
            }
        };

        if (cutoffChart) {
            cutoffChart.destroy();
        }
        
        cutoffChart = new Chart(document.getElementById('cutoffChart'), chartConfig);
        updateChanceIndicator(campus, selectedYear, applicantCategorySelect.value, currentApplicantRank, programSelect.value);
        updateSummaryStatistics(campus, selectedYear);
    }

    // Updates the summary statistics section
    function updateSummaryStatistics(campus, year) {
        const campusYearData = cutoffData[campus]?.[year];
        if (!campusYearData) {
            summaryStatisticsDiv.style.display = 'none';
            return;
        }

        let allCutoffs = [];
        let lowestRank = Infinity;
        let highestRank = 0;
        let lowestCategory = 'N/A';
        let highestCategory = 'N/A';

        for (const program in campusYearData) {
            for (const category in campusYearData[program]) {
                const cutoff = campusYearData[program][category];
                if (cutoff !== null && !isNaN(cutoff)) {
                    allCutoffs.push(cutoff);
                    if (cutoff < lowestRank) {
                        lowestRank = cutoff;
                        lowestCategory = category;
                    }
                    if (cutoff > highestRank) {
                        highestRank = cutoff;
                        highestCategory = category;
                    }
                }
            }
        }

        if (allCutoffs.length > 0) {
            summaryLowestRankSpan.textContent = lowestRank;
            summaryLowestCategorySpan.textContent = lowestCategory;
            summaryHighestRankSpan.textContent = highestRank;
            summaryHighestCategorySpan.textContent = highestCategory;
            summaryStatisticsDiv.style.display = 'block';
        } else {
            summaryStatisticsDiv.style.display = 'none';
        }
        summaryCampusSpan.textContent = campus;
        summaryYearSpan.textContent = year;
    }


    function createTrendChart(campus, program, category) {
        const years = ['2024']; // Only 2024 data is available now
        const trendData = [];
        years.forEach(year => {
            const yearData = cutoffData[campus]?.[year];
            if (yearData && yearData[program] && yearData[program][category] !== undefined) {
                trendData.push(yearData[program][category]);
            } else {
                trendData.push(null); // Push null for missing data points
            }
        });

        const chartData = {
            labels: years,
            datasets: [{
                label: `${program} (${category}) Closing Rank`,
                data: trendData,
                borderColor: '#0096C7', // A consistent color for the trend line
                backgroundColor: 'rgba(0, 150, 199, 0.2)',
                fill: false,
                tension: 0.1
            }]
        };

        const chartConfig = {
            type: 'line',
            data: chartData,
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    x: {
                        title: {
                            display: true,
                            text: 'Year'
                        }
                    },
                    y: {
                        title: {
                            display: true,
                            text: 'Closing Rank'
                        }
                    }
                },
                plugins: {
                    title: {
                        display: true,
                        text: `Trend for NIFT ${campus}, ${program} (${category})`,
                        font: { size: 16 }
                    },
                    legend: {
                        position: 'top',
                    },
                    tooltip: {
                        callbacks: {
                            title: (tooltipItems) => `Year: ${tooltipItems[0].label}`,
                            label: (tooltipItem) => `${tooltipItem.dataset.label}: ${tooltipItem.raw !== null ? tooltipItem.raw : 'N/A'}`
                        }
                    },
                    annotation: {
                        annotations: {
                            line1: {
                                type: 'line',
                                yMin: currentApplicantRank,
                                yMax: currentApplicantRank,
                                borderColor: 'rgb(255, 99, 132)',
                                borderWidth: 2,
                                borderDash: [6, 6],
                                label: {
                                    enabled: true,
                                    content: `Your Rank: ${currentApplicantRank}`,
                                    position: 'start',
                                    backgroundColor: 'rgba(255, 99, 132, 0.8)',
                                    color: 'white',
                                    font: { size: 12 }
                                }
                            }
                        }
                    }
                }
            }
        };

        if (trendChart) {
            trendChart.destroy();
        }
        trendChart = new Chart(document.getElementById('trendChart'), chartConfig);
    }
    
    // Event listeners
    campusSelect.addEventListener('change', () => {
        populateProgramDropdown(); // Update programs based on new campus
        createCutoffChart(campusSelect.value, yearSelect.value, categoryFilterSelect.value);
    });

    yearSelect.addEventListener('change', () => {
        createCutoffChart(campusSelect.value, yearSelect.value, categoryFilterSelect.value);
    });

    programSelect.addEventListener('change', () => {
        // When program selection changes, re-evaluate chances for prospect chart
        updateChanceIndicator(campusSelect.value, yearSelect.value, applicantCategorySelect.value, currentApplicantRank, programSelect.value);
    });

    categoryFilterSelect.addEventListener('change', () => {
        createCutoffChart(campusSelect.value, yearSelect.value, categoryFilterSelect.value);
    });

    applicantCategorySelect.addEventListener('change', () => {
        updateDisplayedRanks(); // Recalculate effective rank
        updateChanceIndicator(campusSelect.value, yearSelect.value, applicantCategorySelect.value, currentApplicantRank, programSelect.value);
        createCutoffChart(campusSelect.value, yearSelect.value, categoryFilterSelect.value); // Redraw chart with new rank line
        createTrendChart(trendCampusSelect.value, trendProgramSelect.value, trendCategorySelect.value); // Redraw trend chart with new rank line
    });


    updateRanksButton.addEventListener('click', () => {
        updateDisplayedRanks();
        createCutoffChart(campusSelect.value, yearSelect.value, categoryFilterSelect.value);
        createTrendChart(trendCampusSelect.value, trendProgramSelect.value, trendCategorySelect.value);
    });

    // Trend Chart event listeners
    trendCampusSelect.addEventListener('change', () => {
        populateTrendProgramDropdown(); // Update programs based on new trend campus
        createTrendChart(trendCampusSelect.value, trendProgramSelect.value, trendCategorySelect.value);
    });

    trendProgramSelect.addEventListener('change', () => {
        createTrendChart(trendCampusSelect.value, trendProgramSelect.value, trendCategorySelect.value);
    });

    trendCategorySelect.addEventListener('change', () => {
        createTrendChart(trendCampusSelect.value, trendProgramSelect.value, trendCategorySelect.value);
    });

    // Populate department select for the "Specializations at a Glance" section
    function populateDepartmentSelect() {
        departmentSelect.innerHTML = ''; // Clear existing options
        for (const dept in bdesSpecializations) {
            const option = document.createElement('option');
            option.value = dept;
            option.textContent = dept;
            departmentSelect.appendChild(option);
        }
        // Set initial display
        if (departmentSelect.value) {
            updateDepartmentDetails();
        }
    }

    // Updates the department details based on selection
    function updateDepartmentDetails() {
        const selectedDept = departmentSelect.value;
        const details = bdesSpecializations[selectedDept];
        if (details) {
            departmentTitle.innerHTML = `${details.icon} ${selectedDept}`;
            departmentDescription.textContent = details.description;
        } else {
            departmentTitle.textContent = 'No details available';
            departmentDescription.textContent = '';
        }
    }

    departmentSelect.addEventListener('change', updateDepartmentDetails);

    // Populate trend program select based on initial campus selection (Bengaluru by default)
    function populateTrendProgramDropdown() {
        const selectedCampus = trendCampusSelect.value;
        const campusData = cutoffData[selectedCampus]?.['2024']; // Only 2024 data
        
        trendProgramSelect.innerHTML = ''; // Clear existing options
        if (campusData) {
            const programs = Object.keys(campusData);
            programs.forEach(program => {
                const option = document.createElement('option');
                option.value = program;
                option.textContent = program;
                trendProgramSelect.appendChild(option);
            });
            // Select the first program by default if available
            if (programs.length > 0) {
                trendProgramSelect.value = programs[0];
            }
        }
    }

    // Toggle info tooltip visibility
    infoTooltipIcon.addEventListener('click', () => {
        const tooltip = document.querySelector('.info-tooltip .tooltiptext');
        if (tooltip.classList.contains('active')) {
            tooltip.classList.remove('active');
        } else {
            tooltip.classList.add('active');
        }
    });

    // Initial load
    window.onload = () => {
        populateDepartmentSelect();
        updateDisplayedRanks();
        populateProgramDropdown();
        populateTrendProgramDropdown(); // Populate for trend chart
        
        // Initial chart renders
        createCutoffChart(campusSelect.value, yearSelect.value, categoryFilterSelect.value);
        createTrendChart(trendCampusSelect.value, trendProgramSelect.value, trendCategorySelect.value);
    };

</script>
</body>
</html>
�
